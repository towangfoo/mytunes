<?xml version="1.0"?>
<config>
	<phpunit>
		<suite>
			<modules>
				<Que_Mytunes/>
			</modules>
		</suite>
	</phpunit>
	
    <modules>
        <Que_Mytunes>
            <version>0.1.1</version>
        </Que_Mytunes>
    </modules>
    <global>
        <models>
            <mytunes>
                <class>Que_Mytunes_Model</class>
                <resourceModel>mytunes_mysql4</resourceModel>
                <!-- 
                <rewrite>
                    <product_type>Que_Mytunes_Model_Product_Type</product_type>
                </rewrite>
                -->
            </mytunes>
            <mytunes_mysql4>
                <class>Que_Mytunes_Model_Mysql4</class>
                <entities>
                    <album>
                        <table>mytunes_albums</table>
                    </album>
                    <track>
                        <table>mytunes_tracks</table>
                    </track>
                    <link>
                        <table>mytunes_links_purchased</table>
                    </link>
                </entities>
            </mytunes_mysql4>
        </models>
        <blocks>
            <mytunes>
                <class>Que_Mytunes_Block</class>
            </mytunes>
            <checkout>
                <rewrite>
                    <onepage_payment>Que_Mytunes_Block_Checkout_Onepage_Payment</onepage_payment>
                </rewrite>
            </checkout>
        </blocks>
        <helpers>
            <mytunes>
                <class>Que_Mytunes_Helper</class>
            </mytunes>
        </helpers>
        <resources>
            <mytunes_setup>
                <setup>
                    <module>Que_Mytunes</module>
                    <class>Que_Mytunes_Model_Mysql4_Resource_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </mytunes_setup>
        </resources>
        <catalog>
            <product>
                <type>
                    <mytunes translate="label">
                        <label>Mytunes Product</label>
                        <model>mytunes/product_type</model>
                        <is_qty>1</is_qty>
                        <price_model>mytunes/product_price</price_model>
                        <!--
                        <index_data_retreiver>downloadable/catalogIndex_data_downloadable</index_data_retreiver>
                        <composite>0</composite>
                        <price_indexer>mytunes/indexer_price</price_indexer>
                        -->
                    </mytunes>
                    <bundle>
                        <allowed_selection_types>
                            <mytunes />
                        </allowed_selection_types>
                    </bundle>
                    <configurable>
                        <allow_product_types>
                            <mytunes />
                        </allow_product_types>
                    </configurable>
                    <grouped>
                        <allow_product_types>
                            <mytunes />
                        </allow_product_types>
                    </grouped>
                </type>
            </product>
        </catalog>
        <pdf>
            <invoice>
                <!-- Renderer for pdf invoice item -->
                <mytunes>mytunes/sales_order_pdf_items_invoice</mytunes>
            </invoice>
            <creditmemo>
                <!-- Renderer for pdf creditmemo item -->
                <mytunes>mytunes/sales_order_pdf_items_creditmemo</mytunes>
            </creditmemo>
        </pdf>
    </global>
    <adminhtml>
        <layout>
            <updates>
                <mytunes>
                    <file>que_mytunes.xml</file>
                </mytunes>
            </updates>
        </layout>
        <translate>
            <modules>
                <Que_Mytunes>
                    <files>
                        <default>Que_Mytunes.csv</default>
                    </files>
                </Que_Mytunes>
            </modules>
        </translate>
        <events>
            <catalog_product_prepare_save>
                <observers>
                    <mytunes_observer>
                        <class>mytunes/observer</class>
                        <method>catalog_product_prepare_save</method>
                    </mytunes_observer>
                </observers>
            </catalog_product_prepare_save>
            <sales_order_invoice_pay>
                <observers>
                    <mytunes_observer>
                        <class>mytunes/observer</class>
                        <method>sales_order_invoice_pay</method>
                    </mytunes_observer>
                </observers>
            </sales_order_invoice_pay>
        </events>
        <acl>
            <resources>
                <admin>
                    <children>
                        <system>
                            <children>
                                <config>
                                    <children>
                                        <mytunes_settings>
                                            <title>Mytunes Settings</title>
                                        </mytunes_settings>
                                    </children>
                                </config>
                            </children>
                        </system>
                        <sales>
                            <children>
                                <mytunes_report>
                                    <title>Mytunes GEMA Reports</title>
                                    <sort_order>900</sort_order>
                                </mytunes_report>
                            </children>
                        </sales>
                    </children>
                </admin>
            </resources>
        </acl>
    </adminhtml>
    <frontend>
        <layout>
            <updates>
                <mytunes module="Que_Mytunes">
                    <file>que_mytunes.xml</file>
                </mytunes>
            </updates>
        </layout>
        <translate>
            <modules>
                <Que_Mytunes>
                    <files>
                        <default>Que_Mytunes.csv</default>
                    </files>
                </Que_Mytunes>
            </modules>
        </translate>
        <routers>
            <mytunes>
                <use>standard</use>
                <args>
                    <module>Que_Mytunes</module>
                    <frontName>mytunes</frontName>
                </args>
            </mytunes>
        </routers>
        <events>
            <sales_order_item_save_after>
                <observers>
                    <mytunes_observer>
                        <class>mytunes/observer</class>
                        <method>sales_order_item_save_after</method>
                    </mytunes_observer>
                </observers>
            </sales_order_item_save_after>
            <sales_order_save_after>
                <observers>
                    <mytunes_observer>
                        <class>mytunes/observer</class>
                        <method>sales_order_save_after</method>
                    </mytunes_observer>
                </observers>
            </sales_order_save_after>
            <payment_method_is_active>
                <observers>
                    <mytunes_observer>
                        <type>singleton</type>
                        <class>mytunes/observer</class>
                        <method>payment_method_is_active</method>
                    </mytunes_observer>
                </observers>
            </payment_method_is_active>
        </events>
    </frontend>
    <admin>
        <routers>
            <mytunesadmin>
                <use>admin</use>
                <args>
                    <module>Que_Mytunes</module>
                    <frontName>mytunesadmin</frontName>
                </args>
            </mytunesadmin>
        </routers>
    </admin>
    <default>
        <mytunes_settings>
            <globals>
                <enabled>1</enabled>
                <albumprice>7.99</albumprice>
                <trackprice>0.59</trackprice>
                <unlimited_downloads>1</unlimited_downloads>
                <num_downloads_if_limited>5</num_downloads_if_limited>
                <open_download_in_new_window>1</open_download_in_new_window>
            </globals>
            <payment>
                <allowall>1</allowall>
                <restrict></restrict>
            </payment>
            <sox>
                <binary>/usr/bin/sox</binary>
                <min_version>14.3.0</min_version>
                <transcode_ogg>1</transcode_ogg>
                <trim_start_default>00:30</trim_start_default>
                <trim_end_default>01:15</trim_end_default>
                <fade_duration_default>1</fade_duration_default>
                <autorename_samples>1</autorename_samples>
            </sox>
        </mytunes_settings>
    </default>
</config>